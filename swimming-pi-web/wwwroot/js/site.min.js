function ui_add_log(n,t){var r=new Date,u=("0"+r.getHours()).slice(-2)+":"+("0"+r.getMinutes()).slice(-2)+":"+("0"+r.getSeconds()).slice(-2),i;t=typeof t=="undefined"?"muted":t;i=$("#debug-template").text();i=i.replace("%%date%%",u);i=i.replace("%%message%%",n);i=i.replace("%%color%%",t);$("#debug").find("li.empty").fadeOut();$("#debug").prepend(i)}function ui_multi_add_file(n,t){var i=$("#files-template").text();i=i.replace("%%filename%%",t.name);i=$(i);i.prop("id","uploaderFile"+n);i.data("file-id",n);$("#files").find("li.empty").fadeOut();$("#files").prepend(i)}function ui_multi_update_file_status(n,t,i){$("#uploaderFile"+n).find("span").html(i).prop("class","status text-"+t)}function ui_multi_update_file_progress(n,t,i,r){i=typeof i=="undefined"?!1:i;r=typeof r=="undefined"?!0:r;var u=$("#uploaderFile"+n).find("div.progress-bar");u.width(t+"%").attr("aria-valuenow",t);u.toggleClass("progress-bar-striped progress-bar-animated",r);t===0?u.html(""):u.html(t+"%");i!==!1&&(u.removeClass("bg-success bg-info bg-warning bg-danger"),u.addClass("bg-"+i))}
/*
 * dmUploader - jQuery Ajax File Uploader Widget
 * https://github.com/danielm/uploader
 *
 * Copyright Daniel Morales <daniel85mg@gmail.com>
 * Released under the MIT license.
 * https://github.com/danielm/uploader/blob/master/LICENSE.txt
 *
 * @preserve
 */
(function(n){"use strict";typeof define=="function"&&define.amd?define(["jquery"],n):typeof exports!="undefined"?module.exports=n(require("jquery")):n(window.jQuery)})(function(n){"use strict";var t="dmUploader",i={PENDING:0,UPLOADING:1,COMPLETED:2,FAILED:3,CANCELLED:4},f={auto:!0,queue:!0,dnd:!0,hookDocument:!0,multiple:!0,url:document.URL,method:"POST",extraData:{},headers:{},dataType:null,fieldName:"file",maxFileSize:0,allowedTypes:"*",extFilter:null,onInit:function(){},onComplete:function(){},onFallbackMode:function(){},onNewFile:function(){},onBeforeUpload:function(){},onUploadProgress:function(){},onUploadSuccess:function(){},onUploadCanceled:function(){},onUploadError:function(){},onUploadComplete:function(){},onFileTypeError:function(){},onFileSizeError:function(){},onFileExtError:function(){},onDragEnter:function(){},onDragLeave:function(){},onDocumentDragEnter:function(){},onDocumentDragLeave:function(){}},u=function(n,t){this.data=n;this.widget=t;this.jqXHR=null;this.status=i.PENDING;this.id=Math.random().toString(36).substr(2)},r;u.prototype.upload=function(){var t=this,u,r;return t.canUpload()?(u=new FormData,u.append(t.widget.settings.fieldName,t.data),r=t.widget.settings.extraData,typeof r=="function"&&(r=r.call(t.widget.element,t.id)),n.each(r,function(n,t){u.append(n,t)}),t.status=i.UPLOADING,t.widget.activeFiles++,t.widget.settings.onBeforeUpload.call(t.widget.element,t.id),t.jqXHR=n.ajax({url:t.widget.settings.url,type:t.widget.settings.method,dataType:t.widget.settings.dataType,data:u,headers:t.widget.settings.headers,cache:!1,contentType:!1,processData:!1,forceSync:!1,xhr:function(){return t.getXhr()},success:function(n){t.onSuccess(n)},error:function(n,i,r){t.onError(n,i,r)},complete:function(){t.onComplete()}}),!0):(t.widget.queueRunning&&t.status!==i.UPLOADING&&t.widget.processQueue(),!1)};u.prototype.onSuccess=function(n){this.status=i.COMPLETED;this.widget.settings.onUploadSuccess.call(this.widget.element,this.id,n)};u.prototype.onError=function(n,t,r){this.status!==i.CANCELLED&&(this.status=i.FAILED,this.widget.settings.onUploadError.call(this.widget.element,this.id,n,t,r))};u.prototype.onComplete=function(){this.widget.activeFiles--;this.status!==i.CANCELLED&&this.widget.settings.onUploadComplete.call(this.widget.element,this.id);this.widget.queueRunning?this.widget.processQueue():this.widget.settings.queue&&this.widget.activeFiles===0&&this.widget.settings.onComplete.call(this.element)};u.prototype.getXhr=function(){var t=this,i=n.ajaxSettings.xhr();return i.upload&&i.upload.addEventListener("progress",function(n){var i=0,r=n.loaded||n.position,u=n.total||n.totalSize;n.lengthComputable&&(i=Math.ceil(r/u*100));t.widget.settings.onUploadProgress.call(t.widget.element,t.id,i)},!1),i};u.prototype.cancel=function(n){n=typeof n=="undefined"?!1:n;var t=this.status;if(t===i.UPLOADING||n&&t===i.PENDING)this.status=i.CANCELLED;else return!1;return this.widget.settings.onUploadCanceled.call(this.widget.element,this.id),t===i.UPLOADING&&this.jqXHR.abort(),!0};u.prototype.canUpload=function(){return this.status===i.PENDING||this.status===i.FAILED};r=function(t,i){return(this.element=n(t),this.settings=n.extend({},f,i),!this.checkSupport())?(n.error("Browser not supported by jQuery.dmUploader"),this.settings.onFallbackMode.call(this.element),!1):(this.init(),this)};r.prototype.checkSupport=function(){if(typeof FormData=="undefined")return!1;var t=new RegExp("/(Android (1.0|1.1|1.5|1.6|2.0|2.1))|(Windows Phone (OS 7|8.0))|(XBLWP)|(ZuneWP)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1.0|2.0|2.5|3.0))/");return t.test(window.navigator.userAgent)?!1:!n('<input type="file" />').prop("disabled")};r.prototype.init=function(){var r=this,i;if(this.queue=[],this.queuePos=-1,this.queueRunning=!1,this.activeFiles=0,this.draggingOver=0,this.draggingOverDoc=0,i=r.element.is("input[type=file]")?r.element:r.element.find("input[type=file]"),i.length>0){i.prop("multiple",this.settings.multiple);i.on("change."+t,function(t){var i=t.target&&t.target.files;i&&i.length&&(r.addFiles(i),n(this).val(""))})}return(this.settings.dnd&&this.initDnD(),i.length===0&&!this.settings.dnd)?(n.error("Markup error found by jQuery.dmUploader"),null):(this.settings.onInit.call(this.element),this)};r.prototype.initDnD=function(){var i=this;i.element.on("drop."+t,function(n){var t,r;(n.preventDefault(),i.draggingOver>0&&(i.draggingOver=0,i.settings.onDragLeave.call(i.element)),t=n.originalEvent&&n.originalEvent.dataTransfer,t&&t.files&&t.files.length)&&(r=[],i.settings.multiple?r=t.files:r.push(t.files[0]),i.addFiles(r))});i.element.on("dragenter."+t,function(n){n.preventDefault();i.draggingOver===0&&i.settings.onDragEnter.call(i.element);i.draggingOver++});i.element.on("dragleave."+t,function(n){n.preventDefault();i.draggingOver--;i.draggingOver===0&&i.settings.onDragLeave.call(i.element)});if(i.settings.hookDocument){n(document).off("drop."+t).on("drop."+t,function(n){n.preventDefault();i.draggingOverDoc>0&&(i.draggingOverDoc=0,i.settings.onDocumentDragLeave.call(i.element))});n(document).off("dragenter."+t).on("dragenter."+t,function(n){n.preventDefault();i.draggingOverDoc===0&&i.settings.onDocumentDragEnter.call(i.element);i.draggingOverDoc++});n(document).off("dragleave."+t).on("dragleave."+t,function(n){n.preventDefault();i.draggingOverDoc--;i.draggingOverDoc===0&&i.settings.onDocumentDragLeave.call(i.element)});n(document).off("dragover."+t).on("dragover."+t,function(n){n.preventDefault()})}};r.prototype.releaseEvents=function(){this.element.off("."+t);this.element.find("input[type=file]").off("."+t);this.settings.hookDocument&&n(document).off("."+t)};r.prototype.validateFile=function(t){if(this.settings.maxFileSize>0&&t.size>this.settings.maxFileSize)return this.settings.onFileSizeError.call(this.element,t),!1;if(this.settings.allowedTypes!=="*"&&!t.type.match(this.settings.allowedTypes))return this.settings.onFileTypeError.call(this.element,t),!1;if(this.settings.extFilter!==null){var i=t.name.toLowerCase().split(".").pop();if(n.inArray(i,this.settings.extFilter)<0)return this.settings.onFileExtError.call(this.element,t),!1}return new u(t,this)};r.prototype.addFiles=function(n){for(var t,u,r=0,i=0;i<n.length;i++)(t=this.validateFile(n[i]),t)&&(u=this.settings.onNewFile.call(this.element,t.id,t.data),u!==!1)&&(this.settings.auto&&!this.settings.queue&&t.upload(),this.queue.push(t),r++);return r===0?this:(this.settings.auto&&this.settings.queue&&!this.queueRunning&&this.processQueue(),this)};r.prototype.processQueue=function(){return(this.queuePos++,this.queuePos>=this.queue.length)?(this.activeFiles===0&&this.settings.onComplete.call(this.element),this.queuePos=this.queue.length-1,this.queueRunning=!1,!1):(this.queueRunning=!0,this.queue[this.queuePos].upload())};r.prototype.restartQueue=function(){this.queuePos=-1;this.queueRunning=!1;this.processQueue()};r.prototype.findById=function(n){for(var i=!1,t=0;t<this.queue.length;t++)if(this.queue[t].id===n){i=this.queue[t];break}return i};r.prototype.cancelAll=function(){var t=this.queueRunning,n;for(this.queueRunning=!1,n=0;n<this.queue.length;n++)this.queue[n].cancel();t&&this.settings.onComplete.call(this.element)};r.prototype.startAll=function(){if(this.settings.queue)this.restartQueue();else for(var n=0;n<this.queue.length;n++)this.queue[n].upload()};r.prototype.methods={start:function(t){if(this.queueRunning)return!1;var r=!1;return typeof t!="undefined"&&(r=this.findById(t),!r)?(n.error("File not found in jQuery.dmUploader"),!1):r?(r.status===i.CANCELLED&&(r.status=i.PENDING),r.upload()):(this.startAll(),!0)},cancel:function(t){var i=!1;return typeof t!="undefined"&&(i=this.findById(t),!i)?(n.error("File not found in jQuery.dmUploader"),!1):i?i.cancel(!0):(this.cancelAll(),!0)},reset:function(){return this.cancelAll(),this.queue=[],this.queuePos=-1,this.activeFiles=0,!0},destroy:function(){this.cancelAll();this.releaseEvents();this.element.removeData(t)}};n.fn.dmUploader=function(i){var u=arguments;if(typeof i=="string")this.each(function(){var f=n.data(this,t);f instanceof r?typeof f.methods[i]=="function"?f.methods[i].apply(f,Array.prototype.slice.call(u,1)):n.error("Method "+i+" does not exist in jQuery.dmUploader"):n.error("Unknown plugin data found by jQuery.dmUploader")});else return this.each(function(){n.data(this,t)||n.data(this,t,new r(this,i))})}});